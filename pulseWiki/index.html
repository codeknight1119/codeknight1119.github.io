<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Web Page</title>
    <!-- You can link your CSS file here -->
    <!-- <link rel="stylesheet" href="style.css"> -->
</head>

<body>

    <header>
        <h1 id="title"></h1>
        <h4>v.8</h4>
        <style>
            .clickable {
                color: blue;
                text-decoration: underline;
                cursor: pointer;
            }
        </style>
    </header>

    <main>
        <div id="main"></div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script>
        async function displayPage(page) {
            try {
                // Fetch and parse JSON
                const response = await fetch("pages.json");
                const pages = await response.json();

                // Update the HTML

                const container = document.getElementById("main");
                container.innerHTML = "";
                document.getElementById("title").textContent = pages[page].title;
                document.getElementById("main").textContent = pages[page].content;
                pages[page].body.forEach(element => {
                    if (element.includes("[[") && element.includes("]]")) {
                        const text = element.split("[[");
                        const text2 = text[1].split("]]");

                        const hyperLink = text2[0];

                        const beforeText = document.createTextNode(text[0].replace(/\*$/, ''));
                        const clickable = document.createElement('span');
                        clickable.textContent = hyperLink;
                        clickable.classList.add('clickable');
                        clickable.addEventListener('click', () => {
                            displayPage(hyperLink);
                        });
                        const afterText = document.createTextNode(text2[1]);

                        container.appendChild(marked.parse(beforeText));
                        container.appendChild(marked.parse(clickable));
                        container.appendChild(marked.parse(afterText));
                    } else {
                        // If the element has no [[ ]], just append it as plain text
                        const plainText = document.createTextNode(element);
                        container.appendChild(plainText);
                    }

                    // Add a line break after each element
                    container.appendChild(document.createElement('br'));
                });



            } catch (error) {
                alert("Error loading page:"+ error);
            }
        }
const urlParams = new URLSearchParams(window.location.search);
if(urlParams.get("startPage") !== null){
displayPage(urlParams.get("startPage"))
}else{
    displayPage("home");
}

    </script>
</body>

</html>